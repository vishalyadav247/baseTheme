{% assign variant = product.selected_or_first_available_variant %}

<div
  class="product-info space-y-4"
  data-product-info
  data-section-id="{{ section.id }}"
  data-product-handle="{{ product.handle }}">
  <form
    method="post"
    action="/cart/add"
    data-product-form
    class="space-y-4">
    <input
      type="hidden"
      name="form_type"
      value="product" />
    <input
      type="hidden"
      name="utf8"
      value="✓" />

    <input
      type="hidden"
      name="id"
      value="{{ variant.id }}"
      data-variant-id-field>

    {% for block in section.blocks %}
      {% case block.type %}

        {% when 'vendor' %}
          {% if product.vendor %}
            <div class="text-sm text-neutral-500" {{ block.shopify_attributes }}>Brand: {{ product.vendor | upcase }}</div>
          {% endif %}

        {% when 'title' %}
          <h1 class="text-2xl font-semibold" {{ block.shopify_attributes }}>{{ product.title }}</h1>

        {% when 'price' %}
          <div
            id="price-container-{{ section.id }}"
            data-price
            {{ block.shopify_attributes }}>
            {% render 'price'
              , variant: variant
              , show_unit: block.settings.show_unit_price %}
          </div>

        {% when 'sku_barcode' %}
          <div class="flex gap-4 text-sm text-neutral-600" {{ block.shopify_attributes }}>
            {% if block.settings.show_sku and variant.sku != blank %}
              <span>SKU:
                <span data-sku>{{ variant.sku }}</span>
              </span>
            {% endif %}
            {% if block.settings.show_barcode and variant.barcode != blank %}
              <span>Barcode:
                <span data-barcode>{{ variant.barcode }}</span>
              </span>
            {% endif %}
          </div>

        {% when 'variant_select' %}
          {% render 'variant-selector'
            , product: product %}

        {% when 'stock_info' %}
          <div class="available-quantity-wrapper">
            {% if block.settings.label != blank %}
              <span>{{ block.settings.label }} :
              </span>
            {% endif %}
            <span data-avalable-quantity>In Stock ( {{ variant.inventory_quantity }} )</span>
          </div>

        {% when 'quantity' %}
          <div class="flex items-center border rounded size-fit" {{ block.shopify_attributes }}>
            <button
              type="button"
              class="px-4 py-2 cursor-pointer"
              data-qty-minus
              aria-label="Decrease quantity">−</button>
            <input
              id="qty-{{ section.id }}"
              type="number"
              name="quantity"
              min="1"
              value="1"
              inputmode="numeric"
              pattern="[0-9]*"
              class="w-15 text-center p-2"
              data-qty-input />
            <button
              type="button"
              class="px-3 py-2 cursor-pointer"
              data-qty-plus
              aria-label="Increase quantity">+</button>
          </div>

        {% when 'notifications' %}
          <div
            class="text-sm pdp-notification"
            data-notifications
            {{ block.shopify_attributes }}></div>
        {% when 'atc' %}
          <button
            type="submit"
            class="btn-atc px-5 py-2 mt-2 border-2 text-lg"
            data-atc
            aria-disabled="{% if variant.available %}false{% else %}true{% endif %}"
            {{ block.shopify_attributes }}>
            {% if variant.available %}Add to cart{% else %}Out Of Stock{% endif %}
          </button>

        {% when 'dynamic_checkout' %}
          <div data-payment-button {{ block.shopify_attributes }}>
            {{ form | payment_button }}
          </div>

        {% when 'description' %}
          <div class="prose max-w-none" {{ block.shopify_attributes }}>
            {{ product.description }}
          </div>

        {% when 'richtext' %}
          <div class="prose max-w-none" {{ block.shopify_attributes }}>
            {{ block.settings.content }}
          </div>

        {% when 'usp' %}
          <div class="flex items-start gap-3" {{ block.shopify_attributes }}>
            {% if block.settings.icon != blank %}
              <span class="text-xl">{{ block.settings.icon }}</span>
            {% endif %}
            <span>{{ block.settings.text }}</span>
          </div>

        {% when 'divider' %}
          <hr class="border-neutral-200 my-2" {{ block.shopify_attributes }}>
      {% endcase %}
    {% endfor %}
  </form>
</div>